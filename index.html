<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Recruiting Resource & Cost Calculator</title>
<style>
  :root {
    --bg-grad-start: #5a6676;
    --bg-grad-end: #3f4857;
    --glass-panel: rgba(255, 255, 255, 0.1);
    --glass-border: rgba(255, 255, 255, 0.2);
    --glass-highlight: rgba(255, 255, 255, 0.3);
    --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.25);
    --text-main: #ffffff;
    --text-muted: rgba(255, 255, 255, 0.6);
    --accent-primary: #3b82f6;
    --accent-glow: rgba(59, 130, 246, 0.5);
    --accent-success: #10b981;
    --accent-warn: #f59e0b;
    --accent-track: rgba(0, 0, 0, 0.2);
    --radius-lg: 24px;
    --radius-md: 16px;
    --radius-sm: 8px;
  }

  [data-theme="light"] {
    --bg-grad-start: #e0e7ff;
    --bg-grad-end: #f3f4f6;
    --glass-panel: rgba(255, 255, 255, 0.65);
    --glass-border: rgba(255, 255, 255, 0.4);
    --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
    --text-main: #1e293b;
    --text-muted: #64748b;
    --accent-track: rgba(0, 0, 0, 0.05);
  }

  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

  body {
    margin: 0; padding: 0;
    height: 100vh;
    font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: linear-gradient(135deg, var(--bg-grad-start), var(--bg-grad-end));
    color: var(--text-main);
    overflow: hidden;
  }

  .glass {
    background: var(--glass-panel);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border: 1px solid var(--glass-border);
    box-shadow: var(--glass-shadow);
  }

  .icon {
    width: 20px; height: 20px;
    stroke: currentColor;
    stroke-width: 2;
    stroke-linecap: round;
    stroke-linejoin: round;
    fill: none;
  }

  .app { height: 100%; display: flex; flex-direction: column; }

  .appHeader {
    display: flex; align-items: center; justify-content: space-between;
    padding: 16px 24px;
    z-index: 10;
    flex-shrink: 0;
  }

  .brand {
    display: flex; align-items: center; gap: 12px;
    font-weight: 600; font-size: 18px; letter-spacing: -0.01em;
    text-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }

  .btn {
    border: 1px solid var(--glass-border);
    background: rgba(255,255,255,0.1);
    color: var(--text-main);
    padding: 8px 16px;
    border-radius: var(--radius-sm);
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex; align-items: center; gap: 6px;
  }
  .btn:hover { background: rgba(255,255,255,0.2); transform: translateY(-1px); }

  .appBody {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
  }

  .container { max-width: 1280px; margin: 0 auto; }

  .grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 24px;
  }
  @media(min-width: 1024px) {
    .grid { grid-template-columns: 420px 1fr; }
  }

  .card {
    border-radius: var(--radius-lg);
    padding: 24px;
    margin-bottom: 24px;
    transition: transform 0.2s;
  }

  h3 {
    margin: 0 0 16px 0;
    font-size: 13px;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--text-muted);
    display: flex; align-items: center; gap: 8px;
  }

  .control-group { margin-bottom: 20px; }
  .control-group:last-child { margin-bottom: 0; }

  .label-row {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 8px; font-size: 13px; font-weight: 500;
    color: var(--text-muted);
  }
  .val-tag {
    background: rgba(255,255,255,0.15);
    padding: 2px 8px; border-radius: 6px;
    color: var(--text-main); font-weight: 600;
    font-variant-numeric: tabular-nums;
  }

  input[type=range] {
    width: 100%; -webkit-appearance: none; appearance: none;
    background: transparent; cursor: pointer;
  }
  input[type=range]::-webkit-slider-runnable-track {
    height: 8px; border-radius: 4px;
    background: var(--accent-track);
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
  }
  input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none;
    height: 20px; width: 20px;
    border-radius: 50%;
    background: var(--text-main);
    margin-top: -6px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    border: 2px solid rgba(255,255,255,0.8);
    transition: transform 0.1s;
  }
  input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.15); }

  /* Efficiency Levers: filled portion of track uses green / purple (--value set by JS) */
  input#eff::-webkit-slider-runnable-track {
    background: linear-gradient(to right, #10b981 0%, #10b981 var(--value, 25%), var(--accent-track) var(--value, 25%), var(--accent-track) 100%);
  }
  input#eff::-moz-range-track { background: var(--accent-track); }
  input#eff::-moz-range-progress { background: #10b981; }
  input#self::-webkit-slider-runnable-track {
    background: linear-gradient(to right, #8b5cf6 0%, #8b5cf6 var(--value, 25%), var(--accent-track) var(--value, 25%), var(--accent-track) 100%);
  }
  input#self::-moz-range-track { background: var(--accent-track); }
  input#self::-moz-range-progress { background: #8b5cf6; }

  select {
    width: 100%; padding: 10px 14px;
    border-radius: var(--radius-md);
    border: 1px solid var(--glass-border);
    background: rgba(0,0,0,0.2);
    color: var(--text-main);
    font-size: 14px; outline: none;
    backdrop-filter: blur(10px);
  }
  option { background: #3f4857; color: #fff; }

  .kpi-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 24px; }
  .kpi-card {
    border-radius: var(--radius-md);
    padding: 16px;
    text-align: center;
    position: relative;
    overflow: hidden;
  }
  .kpi-card::before {
    content: ''; position: absolute; top:0; left:0; right:0; height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
  }
  .kpi-label { font-size: 11px; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-muted); }
  .kpi-value {
    font-size: 28px; font-weight: 700; margin: 8px 0 4px 0;
    text-shadow: 0 2px 8px rgba(0,0,0,0.2);
  }
  .kpi-sub { font-size: 11px; opacity: 0.7; }
  .kpi-glow { color: #60a5fa; text-shadow: 0 0 12px rgba(59, 130, 246, 0.6); }

  .table-container {
    border-radius: var(--radius-lg);
    overflow: auto;
    margin-bottom: 24px;
  }
  .cost-table { width: 100%; border-collapse: collapse; font-size: 13px; }
  .cost-table th {
    text-align: left; padding: 12px 16px;
    background: rgba(0,0,0,0.1);
    color: var(--text-muted); font-weight: 600;
    white-space: nowrap;
  }
  .cost-table th.num { text-align: right; }
  .cost-table td {
    padding: 12px 16px;
    border-bottom: 1px solid var(--glass-border);
  }
  .cost-table tr:last-child td { border-bottom: none; }
  .cost-table .num { text-align: right; font-variant-numeric: tabular-nums; }

  .row-highlight { background: rgba(59, 130, 246, 0.08); }
  .row-dim { background: rgba(255, 255, 255, 0.02); }
  /* Sourcing/Screening - baby blue (aligned with funnel top) */
  .row-offshore { background: rgba(59, 130, 246, 0.12); }
  /* Local Hiring Support - green (aligned with funnel confirmed/starts) */
  .row-admin { background: rgba(16, 185, 129, 0.15); }
  /* Onboarding Support - dulled purple (aligned with funnel passed interview) */
  .row-onboarding { background: rgba(139, 92, 246, 0.12); }
  /* Finalization - pink (aligned with funnel passed screening) */
  .row-onshore { background: rgba(236, 72, 153, 0.12); }
  [data-theme="light"] .row-offshore { background: rgba(59, 130, 246, 0.1); }
  [data-theme="light"] .row-admin { background: rgba(16, 185, 129, 0.1); }
  [data-theme="light"] .row-onboarding { background: rgba(139, 92, 246, 0.1); }
  [data-theme="light"] .row-onshore { background: rgba(236, 72, 153, 0.1); }

  /* --- Rate Input Styles --- */
  .rate-cell {
    padding: 8px 12px !important;
  }
  .rate-input-wrap {
    display: flex;
    align-items: center;
    gap: 2px;
    font-size: 13px;
    color: var(--text-main);
  }
  .rate-symbol {
    font-weight: 500;
    opacity: 0.7;
    font-size: 12px;
  }
  .rate-input {
    width: 70px;
    padding: 5px 6px;
    border-radius: 6px;
    border: 1px solid var(--glass-border);
    background: rgba(0,0,0,0.2);
    color: var(--text-main);
    font-size: 13px;
    font-weight: 600;
    text-align: right;
    outline: none;
    font-variant-numeric: tabular-nums;
    font-family: inherit;
    transition: border-color 0.2s, box-shadow 0.2s;
  }
  .rate-input:focus {
    border-color: var(--accent-primary);
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3);
  }
  .rate-input::-webkit-outer-spin-button,
  .rate-input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  .rate-input[type=number] {
    -moz-appearance: textfield;
  }
  .rate-annual {
    font-size: 11px;
    color: var(--text-muted);
    margin-top: 3px;
    font-variant-numeric: tabular-nums;
  }
  [data-theme="light"] .rate-input {
    background: rgba(0,0,0,0.05);
  }
  .row-inactive {
    opacity: 0.45;
  }

  /* --- Funnel Bars --- */
  .funnel-container { padding-top: 8px; }
  .bar-row { margin-bottom: 14px; }
  .bar-meta { display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 6px; }
  .bar-track {
    height: 8px; background: var(--accent-track);
    border-radius: 4px; overflow: hidden;
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.2);
  }
  .bar-fill {
    height: 100%; border-radius: 4px;
    position: relative;
  }
  .bar-fill::after {
    content:''; position: absolute; top:0; left:0; right:0; bottom:0;
    background: linear-gradient(180deg, rgba(255,255,255,0.2), transparent);
  }

  .c-blue { background: #3b82f6; box-shadow: 0 0 10px rgba(59,130,246,0.4); }
  .c-purple { background: #8b5cf6; box-shadow: 0 0 10px rgba(139,92,246,0.4); }
  .c-pink { background: #ec4899; box-shadow: 0 0 10px rgba(236,72,153,0.4); }
  .c-emerald { background: #10b981; box-shadow: 0 0 10px rgba(16,185,129,0.4); }
</style>
</head>
<body data-theme="dark">

<div class="app">
  <header class="appHeader glass">
    <div class="brand">
      <svg class="icon" viewBox="0 0 24 24"><path d="M2 20h20M4 14l5-5 5 5 5-5M4 18v-4M20 18v-4" /></svg>
      Resource & Cost Calculator
    </div>
    <div style="display:flex; gap:10px;">
      <button class="btn" id="btnDark">
        <svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>
        Theme
      </button>
      <button class="btn" id="btnReset">
        <svg class="icon" viewBox="0 0 24 24"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>
        Reset
      </button>
    </div>
  </header>

  <main class="appBody">
    <div class="container">
      <div class="grid">

        <div>
          <div class="card glass">
            <h3>
              <svg class="icon" viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
              Recruiting Volume
            </h3>

            <div class="control-group">
              <div class="label-row"><span>Weekly Starts (Arrivals) Target</span><span class="val-tag" id="val-starts">76</span></div>
              <input id="starts" type="range" min="1" max="500" value="76">
            </div>

            <div class="control-group" style="margin-top:24px;">
              <select id="profileSelect">
                <option value="light-industrial" selected>Light Industrial (Entry-Level)</option>
                <option value="skilled-trades">Skilled Trades</option>
                <option value="professional">Professional / Office</option>
                <option value="high-vol">High-Vol Warehouse</option>
                <option value="custom">Custom Configuration...</option>
              </select>
            </div>

            <div style="margin-top:20px; padding-top:20px; border-top:1px solid var(--glass-border);">
              
              <div class="control-group">
                <div class="label-row"><span>Outreach Success Rate</span><span class="val-tag" id="val-outreach">33%</span></div>
                <input id="outreach" type="range" min="0" max="100" value="33">
              </div>
<div class="control-group">
                <div class="label-row"><span>Interview Show Rate</span><span class="val-tag" id="val-show">60%</span></div>
                <input id="show" type="range" min="0" max="100" value="60">
              </div>
              <div class="control-group">
                <div class="label-row"><span>Quality Pass Rate</span><span class="val-tag" id="val-pass">75%</span></div>
                <input id="pass" type="range" min="0" max="100" value="75">
              </div>
              <div class="control-group">
                <div class="label-row"><span>Screening Pass Rate</span><span class="val-tag" id="val-screen">80%</span></div>
                <input id="screen" type="range" min="0" max="100" value="80">
              </div>
              <div class="control-group">
                <div class="label-row"><span>Day 1 Arrival Rate</span><span class="val-tag" id="val-arrive">75%</span></div>
                <input id="arrive" type="range" min="0" max="100" value="75">
              </div>
            </div>
          </div>

          <div class="card glass" style="border-left: 4px solid var(--accent-primary);">
            <h3>
              <svg class="icon" viewBox="0 0 24 24"><line x1="4" y1="21" x2="4" y2="14"/><line x1="4" y1="10" x2="4" y2="3"/><line x1="12" y1="21" x2="12" y2="12"/><line x1="12" y1="8" x2="12" y2="3"/><line x1="20" y1="21" x2="20" y2="16"/><line x1="20" y1="12" x2="20" y2="3"/><line x1="1" y1="14" x2="7" y2="14"/><line x1="9" y1="8" x2="15" y2="8"/><line x1="17" y1="16" x2="23" y2="16"/></svg>
              Efficiency Levers
            </h3>

            <div class="control-group">
              <div class="label-row">
                <span>Local Hiring Support Required</span>
                <span class="val-tag" id="val-eff">25%</span>
              </div>
              <input id="eff" type="range" min="0" max="100" value="25">
              <div style="font-size:11px; color:var(--text-muted); margin-top:6px;">
                <span id="txt-admin">Local Hiring Support set to 25%: routes 25% to Local Hiring Support ($20.00/hr) and 75% to offshore recruiters.</span>
              </div>
            </div>

            <div class="control-group" style="margin-top:16px;">
              <div class="label-row">
                <span>Self-Service Onboarding</span>
                <span class="val-tag" id="val-self">25%</span>
              </div>
              <input id="self" type="range" min="0" max="100" value="25">
              <div style="font-size:11px; color:var(--text-muted); margin-top:6px;">
                Reduces demand on Offshore Onboarding team
              </div>
            </div>
          </div>

          <div class="card glass">
            <h3>
              <svg class="icon" viewBox="0 0 24 24"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
              Productivity Assumptions (Daily)
            </h3>

            <div class="control-group">
              <div class="label-row"><span>Recruiter Interviews / Day</span><span class="val-tag" id="val-intpd">10</span></div>
              <input id="intpd" type="range" min="1" max="30" step="1" value="10">
            </div>
            <div class="control-group">
              <div class="label-row"><span>Onboards Processed / Day</span><span class="val-tag" id="val-onbpd">20</span></div>
              <input id="onbpd" type="range" min="1" max="30" step="1" value="20">
            </div>
            <div class="control-group">
              <div class="label-row"><span>Finalizations / Day (Onshore)</span><span class="val-tag" id="val-finpd">12</span></div>
              <input id="finpd" type="range" min="1" max="30" step="1" value="12">
            </div>
            <div class="control-group">
              <div class="label-row"><span>Working Days / Week</span><span class="val-tag" id="val-days">5</span></div>
              <input id="days" type="range" min="1" max="7" value="5">
            </div>
          </div>
        </div>

        <div>
          <div class="kpi-grid">
            <div class="kpi-card glass">
              <div class="kpi-label">Headcount</div>
              <div class="kpi-value" id="kpi-hc">0</div>
              <div class="kpi-sub">FTEs Required</div>
            </div>
            <div class="kpi-card glass">
              <div class="kpi-label">Weekly Cost</div>
              <div class="kpi-value" id="kpi-cost">$0</div>
              <div class="kpi-sub">Total Labor Spend</div>
            </div>
            <div class="kpi-card glass" style="background: rgba(59, 130, 246, 0.15); border-color: rgba(59, 130, 246, 0.4);">
              <div class="kpi-label" style="color: #93c5fd;">Cost Per Start</div>
              <div class="kpi-value kpi-glow" id="kpi-cps">$0</div>
              <div class="kpi-sub" style="color: #93c5fd;">Efficiency Metric</div>
            </div>
          </div>

          <div class="table-container glass">
            <div style="padding:16px; border-bottom:1px solid var(--glass-border);">
              <h3 style="margin:0;">
                <svg class="icon" viewBox="0 0 24 24"><rect x="2" y="5" width="20" height="14" rx="2"/><line x1="2" y1="10" x2="22" y2="10"/></svg>
                Resource & Cost Breakdown
              </h3>
            </div>
            <table class="cost-table">
              <thead>
                <tr>
                  <th>Function & Role</th>
                  <th>Rate</th>
                  <th class="num">FTEs</th>
                  <th class="num">Weekly Cost</th>
                </tr>
              </thead>
              <tbody>
                <!-- Offshore Sourcing / Screening -->
                <tr class="row-offshore" id="row-offrec">
                  <td>
                    <div style="font-weight:500;">Sourcing / Screening</div>
                    <div style="font-size:11px; color:var(--text-muted);">Offshore</div>
                  </td>
                  <td class="rate-cell">
                    <div class="rate-input-wrap">
                      <span class="rate-symbol">$</span>
                      <input type="number" class="rate-input" id="rate-offrec" value="10.38" step="0.01" min="0">
                      <span class="rate-symbol">/hr</span>
                    </div>
                    <div class="rate-annual" id="annual-offrec"></div>
                  </td>
                  <td class="num" id="fte-offrec">0</td>
                  <td class="num" id="cost-offrec">$0</td>
                </tr>

                <!-- Local Hiring Support -->
                <tr class="row-admin" id="row-admin">
                  <td>
                    <div style="font-weight:500;">Local Hiring Support</div>
                    <div style="font-size:11px; color:var(--text-muted);">Local</div>
                  </td>
                  <td class="rate-cell">
                    <div class="rate-input-wrap">
                      <span class="rate-symbol">$</span>
                      <input type="number" class="rate-input" id="rate-admin" value="20.00" step="0.01" min="0">
                      <span class="rate-symbol">/hr</span>
                    </div>
                    <div class="rate-annual" id="annual-admin"></div>
                  </td>
                  <td class="num" id="fte-admin">0</td>
                  <td class="num" id="cost-admin">$0</td>
                </tr>

                <!-- Offshore Onboarding -->
                <tr class="row-onboarding" id="row-offonb">
                  <td>
                    <div style="font-weight:500;">Onboarding Support</div>
                    <div style="font-size:11px; color:var(--text-muted);">Offshore</div>
                  </td>
                  <td class="rate-cell">
                    <div class="rate-input-wrap">
                      <span class="rate-symbol">$</span>
                      <input type="number" class="rate-input" id="rate-offonb" value="10.38" step="0.01" min="0">
                      <span class="rate-symbol">/hr</span>
                    </div>
                    <div class="rate-annual" id="annual-offonb"></div>
                  </td>
                  <td class="num" id="fte-offonb">0</td>
                  <td class="num" id="cost-offonb">$0</td>
                </tr>

                <!-- Onshore Finalization -->
                <tr class="row-onshore" id="row-fin">
                  <td>
                    <div style="font-weight:500;">Finalization (I-9 / Drug Screen)</div>
                    <div style="font-size:11px; color:var(--text-muted);">Onshore FTE</div>
                  </td>
                  <td class="rate-cell">
                    <div class="rate-input-wrap">
                      <span class="rate-symbol">$</span>
                      <input type="number" class="rate-input" id="rate-fin" value="33.65" step="0.01" min="0">
                      <span class="rate-symbol">/hr</span>
                    </div>
                    <div class="rate-annual" id="annual-fin"></div>
                  </td>
                  <td class="num" id="fte-fin">0</td>
                  <td class="num" id="cost-fin">$0</td>
                </tr>

                <!-- Total -->
                <tr style="font-weight:700; background:rgba(255,255,255,0.05);">
                  <td>Total</td>
                  <td></td>
                  <td class="num" id="fte-total">0</td>
                  <td class="num" id="cost-total">$0</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="card glass">
            <h3>
              <svg class="icon" viewBox="0 0 24 24"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
              Recruiting Funnel
            </h3>

            <div class="funnel-container">
              
              <div class="bar-row">
                <div class="bar-meta"><span>Candidate Outreach Attempts</span><span id="n-outreach">0</span></div>
                <div class="bar-track"><div class="bar-fill c-blue" id="b-outreach" style="width:100%; opacity:0.55;"></div></div>
              </div>
<div class="bar-row">
                <div class="bar-meta"><span>Scheduled Interviews Required</span><span id="n-sched">0</span></div>
                <div class="bar-track"><div class="bar-fill c-blue" id="b-sched" style="width:100%"></div></div>
              </div>
              <div class="bar-row">
                <div class="bar-meta"><span>Passed Interview (Onboard Vol)</span><span id="n-pass">0</span></div>
                <div class="bar-track"><div class="bar-fill c-purple" id="b-pass" style="width:60%"></div></div>
              </div>
              <div class="bar-row">
                <div class="bar-meta"><span>Passed Screening (Finalize Vol)</span><span id="n-screen">0</span></div>
                <div class="bar-track"><div class="bar-fill c-pink" id="b-screen" style="width:40%"></div></div>
              </div>
              <div class="bar-row">
                <div class="bar-meta"><span>Confirmed to Start</span><span id="n-conf">0</span></div>
                <div class="bar-track"><div class="bar-fill c-emerald" id="b-conf" style="width:30%"></div></div>
              </div>
              <div class="bar-row" style="margin-top:24px;">
                <div class="bar-meta">
                  <span style="font-weight:700; color:#fff;">Actual Starts</span>
                  <span id="n-starts" style="color:var(--accent-success); font-weight:700; font-size:16px;">0</span>
                </div>
                <div class="bar-track" style="height:10px; background:rgba(16,185,129,0.2);">
                  <div class="bar-fill c-emerald" style="width:100%"></div>
                </div>
              </div>
              <div style="margin-top:16px; font-size:12px; opacity:0.6; text-align:right;">
                Conversion Ratio: <strong id="val-ratio">0:1</strong> (Scheduled Interviews : Start)
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </main>
</div>

<script>
(function() {
  const PRESETS = {
    "light-industrial": { outreach: 33, show: 60, pass: 75, screen: 80, arrive: 75 },
    "skilled-trades":   { outreach: 28, show: 70, pass: 65, screen: 85, arrive: 80 },
    "professional":     { outreach: 45, show: 80, pass: 80, screen: 95, arrive: 90 },
    "high-vol":         { outreach: 25, show: 55, pass: 80, screen: 75, arrive: 65 },
  };

  const DEFAULTS = {
    starts: 76,
    outreach: 33,
    show: 60, pass: 75, screen: 80, arrive: 75,
    eff: 25,
    self: 25,
    intpd: 10,
    onbpd: 20,
    finpd: 12,
    days: 5,
    rateOffRec: 10.38,
    rateAdmin: 20.00,
    rateOffOnb: 10.38,
    rateFin: 33.65
  };

  let state = { ...DEFAULTS };

  const el = (id) => document.getElementById(id);
  const fmtUSD = (n) => '$' + Math.round(n).toLocaleString();
  const fmtInt = (n) => Math.round(n).toLocaleString();

  function calculate() {
    // 1. Funnel (bottom-up)
    const arrivals  = state.starts;
    const confirmed = arrivals   / (state.arrive / 100);
    const screened  = confirmed  / (state.screen / 100);
    const passed    = screened   / (state.pass   / 100);
    const scheduled = passed     / (state.show   / 100);

    // Candidate outreach (top-of-funnel volume)
    const outreachAttempts = scheduled / (state.outreach / 100);

    // 2. Workload splits
    // eff = Local Hiring Support Required % (routed to Local Hiring Support)
    const volAdmin        = scheduled * (state.eff / 100);
    const volOffshore     = scheduled * ((100 - state.eff) / 100);
    const volOnboarding   = passed * ((100 - state.self) / 100);
    const volFinalization = screened;

    // 3. Capacity & headcount
    const capRec = state.intpd  * state.days;
    const capOnb = state.onbpd  * state.days;
    const capFin = state.finpd  * state.days;

    const hcRecOff   = Math.ceil(volOffshore     / (capRec || 1));
    const hcAdmin    = Math.ceil(volAdmin        / (capRec || 1));
    const hcOnbOff   = Math.ceil(volOnboarding   / (capOnb || 1));
    const hcFinOn    = Math.ceil(volFinalization  / (capFin || 1));
    const totalHc    = hcRecOff + hcAdmin + hcOnbOff + hcFinOn;

    // 4. Cost (weekly = FTE × $/hr × 40)
    const costRecOff = hcRecOff * state.rateOffRec * 40;
    const costAdmin  = hcAdmin  * state.rateAdmin  * 40;
    const costOnbOff = hcOnbOff * state.rateOffOnb * 40;
    const costFin    = hcFinOn  * state.rateFin    * 40;
    const totalCost  = costRecOff + costAdmin + costOnbOff + costFin;
    const cps        = arrivals > 0 ? totalCost / arrivals : 0;

    // --- Render ---

    // KPIs
    el('kpi-hc').textContent   = totalHc;
    el('kpi-cost').textContent = fmtUSD(totalCost);
    el('kpi-cps').textContent  = fmtUSD(cps);
    el('val-ratio').textContent = (scheduled / arrivals).toFixed(1) + ':1';

    // Table cells (in-place, no rebuild)
    el('fte-offrec').textContent  = hcRecOff;
    el('cost-offrec').textContent = fmtUSD(costRecOff);
    el('annual-offrec').textContent = '(' + fmtUSD(state.rateOffRec * 2080) + '/yr)';

    el('fte-admin').textContent  = hcAdmin;
    el('cost-admin').textContent = fmtUSD(costAdmin);
    el('annual-admin').textContent = '(' + fmtUSD(state.rateAdmin * 2080) + '/yr)';

    el('fte-offonb').textContent  = hcOnbOff;
    el('cost-offonb').textContent = fmtUSD(costOnbOff);
    el('annual-offonb').textContent = '(' + fmtUSD(state.rateOffOnb * 2080) + '/yr)';

    el('fte-fin').textContent  = hcFinOn;
    el('cost-fin').textContent = fmtUSD(costFin);
    el('annual-fin').textContent = '(' + fmtUSD(state.rateFin * 2080) + '/yr)';

    el('fte-total').textContent  = totalHc;
    el('cost-total').textContent = fmtUSD(totalCost);

    // Dim admin row when inactive
    const adminRow = el('row-admin');
    if (hcAdmin > 0) {
      adminRow.classList.remove('row-inactive');
    } else {
      adminRow.classList.add('row-inactive');
    }

    // Funnel bars
    const fMax = outreachAttempts;

    el('n-outreach').textContent = fmtInt(outreachAttempts);
    el('b-outreach').style.width = '100%';

    el('n-sched').textContent = fmtInt(scheduled);
    el('b-sched').style.width = Math.max(1, (scheduled / fMax) * 100) + '%';

    el('n-pass').textContent = fmtInt(passed);
    el('b-pass').style.width = Math.max(1, (passed / fMax) * 100) + '%';

    el('n-screen').textContent = fmtInt(screened);
    el('b-screen').style.width = Math.max(1, (screened / fMax) * 100) + '%';

    el('n-conf').textContent = fmtInt(confirmed);
    el('b-conf').style.width = Math.max(1, (confirmed / fMax) * 100) + '%';

    el('n-starts').textContent = fmtInt(arrivals);

    // Efficiency Levers dynamic text
    const localPct = state.eff;
    const offshorePct = 100 - state.eff;
    el('txt-admin').textContent =
      'Local Hiring Support set to ' + localPct + '%: routes ' + localPct + '% to Local Hiring Support ($' + state.rateAdmin.toFixed(2) + '/hr) and ' +
      offshorePct + '% to offshore recruiters.';
  }

  // --- Slider event wiring ---
  const sliders = ['starts','outreach','show','pass','screen','arrive','eff','self','intpd','onbpd','finpd','days'];

  function updateEfficiencySliderFills() {
    el('eff').style.setProperty('--value', state.eff + '%');
    el('self').style.setProperty('--value', state.self + '%');
  }

  sliders.forEach(key => {
    el(key).addEventListener('input', (e) => {
      state[key] = parseFloat(e.target.value);
      const badge = el('val-' + key);
      if (badge) {
        badge.textContent = ['outreach','show','pass','screen','arrive','eff','self'].includes(key)
          ? state[key] + '%'
          : state[key];
      }
      if (['outreach','show','pass','screen','arrive'].includes(key)) el('profileSelect').value = 'custom';
      if (key === 'eff' || key === 'self') updateEfficiencySliderFills();
      calculate();
    });
  });

  // --- Rate input wiring ---
  const rateMap = {
    'rate-offrec': 'rateOffRec',
    'rate-admin':  'rateAdmin',
    'rate-offonb': 'rateOffOnb',
    'rate-fin':    'rateFin'
  };

  Object.entries(rateMap).forEach(([inputId, stateKey]) => {
    el(inputId).addEventListener('input', (e) => {
      state[stateKey] = parseFloat(e.target.value) || 0;
      calculate();
    });
  });

  // --- Profile select ---
  el('profileSelect').addEventListener('change', (e) => {
    const p = PRESETS[e.target.value];
    if (p) {
      ['outreach','show','pass','screen','arrive'].forEach(k => {
        state[k] = p[k];
        el(k).value = p[k];
        el('val-' + k).textContent = p[k] + '%';
      });
      calculate();
    }
  });

  // --- Theme toggle ---
  el('btnDark').addEventListener('click', () => {
    const b = document.body;
    b.setAttribute('data-theme', b.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
  });

  // --- Reset ---
  el('btnReset').addEventListener('click', () => {
    state = { ...DEFAULTS };

    // Reset sliders & badges
    sliders.forEach(k => {
      el(k).value = state[k];
      const badge = el('val-' + k);
      if (badge) {
        badge.textContent = ['show','pass','screen','arrive','eff','self'].includes(k)
          ? state[k] + '%'
          : state[k];
      }
    });

    // Reset rate inputs
    Object.entries(rateMap).forEach(([inputId, stateKey]) => {
      el(inputId).value = state[stateKey];
    });

    el('profileSelect').value = 'light-industrial';
    updateEfficiencySliderFills();
    calculate();
  });

  // --- Init ---
  updateEfficiencySliderFills();
  calculate();
})();
</script>
</body>
</html>